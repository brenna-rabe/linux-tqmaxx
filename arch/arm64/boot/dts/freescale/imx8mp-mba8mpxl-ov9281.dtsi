// SPDX-License-Identifier: (GPL-2.0-or-later OR MIT)
/*
 * Copyright (c) 2021-2023 TQ-Systems GmbH <linux@ew.tq-group.com>,
 * D-82229 Seefeld, Germany.
 * Author: Alexander Stein
 */

/ {
	/* This voltage converter is located on the adapter board MBaxCA */
	reg_mipi_csi_v3v3: regulator-mipi-csi-v3v3 {
		compatible = "regulator-fixed";
		regulator-name = "MIPI_CSI_V_3V3";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		vin-supply = <&reg_vcc_5v0>;
	};
};

&cameradev {
	status = "okay";
};

/*
 * Dual use: Trigger / Sync / Enable for mipi_csi_0
 */
&ecspi1 {
	status = "disabled";
};

&mipi_csi_0 {
	status = "okay";

	port@0 {
		mipi0_sensor_ep: endpoint {
			remote-endpoint = <&ov9281_ep0>;
			data-lanes = <2>;
			csis-hs-settle = <13>;
			csis-clk-settle = <2>;
			csis-wclk;
		};
	};
};

&isi_0 {
	status = "okay";

	cap_device {
		status = "okay";
	};
};

&i2c4 {
	vc_ctrl: controller@10 {
		compatible = "vision-components,mipi-module";
		reg = <0x10>;
		#clock-cells = <0>;
		vcc-supply = <&reg_mipi_csi_v3v3>;
		clock-frequency = <24000000>;
	};

	camera@60 {
		compatible = "ovti,ov9281";
		reg = <0x60>;
		clocks = <&vc_ctrl>;

		avdd-supply = <&vc_ctrl>;
		dovdd-supply = <&vc_ctrl>;
		dvdd-supply = <&vc_ctrl>;

		port {
			ov9281_ep0: endpoint {
				remote-endpoint = <&mipi0_sensor_ep>;
				data-lanes = <1 2>;
				clock-lanes = <0>;
				clock-noncontinuous = <1>;
				link-frequencies = /bits/ 64 <400000000>;
			};
		};
	};
};

